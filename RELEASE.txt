SLS Detector Package Major Release 7.x.x released on 10.11.2023
===============================================================

This document describes the differences between v8.0.0 and v7.0.3



    CONTENTS
    --------
    1           New, Changed or Resolved Features
        1.1     Breaking API
        1.2     Resolved or Changed Features
        1.3     New Features
    2           On-board Detector Server Compatibility
    3           Firmware Requirements
    4           Kernel Requirements
    5           Download, Documentation & Support




1 New, Changed or Resolved Features
=====================================


1.1 Breaking API
==================


    Detector
    --------

    *   [Moench] Development mode
        Moench is now being made compatible with Jungfrau v2.0 readout boards. 
        Hence, firmware and software is in development mode. 
        7.x.x will continue to have fixes for Moench until this version is deployed.


    Client
    ======

    *   [Eiger] Febl and Febr firmware versions [fx30, fx70]
        Command line: hardwareversion, versions (modified to include this)
        API: Detector::getFrontEndFirmwareVersion, 
        Detector::getHardwareVersion(modified to include for Eiger)
        slsDetectorDefs::fpgaPosition {FRONT_LEFT, FRONT_RIGHT}



1.2 Resolved or Changed Features
================================


    Detector Server
    ---------------


    *   Set bit and clear bit validation
        Previously, validation expected all the other bits in the register to 
        not change. Now, it only validates the selected bit.

        
    *   [Ctb] Patioctrl, patsetbit, patbitmask
        MSB (64 bit unsigned) could not be set as a value of -1 was interpreted 
        as a 'get'. Fixed in server. 

    
    *   [Ctb] Allow dac tristate when v_limit is set
        Fixed.


    Simulator
    ---------

    *   Unique TCP port for multiple simulators
        Checks include unique TCP port-hostname combo.


    Receiver
    --------

    *   Unique TCP port for multiple receivers
        7.x.x already has automatically increasing TCP ports in shared memory 
        for multiple receivers. Now, checks include unique TCP port-hostname 
        combo.

    *   [Ctb] Readout mode updated
        'rx_hostname' should configure the receiver with parameters from detector,
        but readout mode in receiver always configured at start up to Analog only. 
        Fixed.


1.3 New Features
================


    Detector Server
    ---------------


    *   [Ctb] List for ADC, signal, power, slowadc 
        Also allow their list to set names and to obtain their indices and values.

        Command line: dacname, dacindex, 
        adclist, adcname, adcindex, 
        signallist, signalname,signalindex, 
        powerlist, powername, powerindex, powervalues,
        slowadclist, slowadcname, slowadcindex, slowadcvalues

        API: get/setDacName, getDacIndex, 
        get/setAdcNames, getAdcIndex, get/setAdcName,
        get/setSignalNames, getSignalIndex, get/setSignalName,
        get/setPowerNames, getPowerIndex, get/setPowerName, getPowerList,
        get/setSlowADCNames, getSlowADCIndex, get/setSlowADCName, getSlowADCList

        





- fix ctb slow adcs



2  On-board Detector Server Compatibility
==========================================


    Eiger       8.0.0
    Jungfrau    8.0.0
    Mythen3     8.0.0
    Gotthard2   8.0.0
    Gotthard    8.0.0
    Moench      8.0.0
    Ctb         8.0.0
    

    On-board Detector Server Upgrade
    --------------------------------

    From v6.1.0 (without tftp):
        Using command 'updatedetectorserver'
    From 5.0.0 (with tftp):
        Using command 'copydetectorserver'

    Instructions available at
        https://slsdetectorgroup.github.io/devdoc/serverupgrade.html




3 Firmware Requirements
========================


    Eiger       02.10.2023 (v32)                    (updated in 7.0.3)
    
    Jungfrau    16.05.2023 (v1.4.1, HW v1.0)        (updated in 7.0.3)
                15.05.2023 (v2.4.1, HW v2.0)        (updated in 7.0.3)

    Mythen3     24.01.2023 (v1.4)                   (updated in 7.0.0)

    Gotthard2   23.11.2022 (v0.3)                   (updated in 7.0.0)

    Gotthard    08.02.2018 (50um and 25um Master)
                09.02.2018 (25 um Slave) 

    Moench      10.07.2023 (v0.3.2)                (updated in 8.0.0, under development)

    Ctb         05.07.2023 (v1.2)                  (updated in 8.0.0)


    Detector Upgrade
    ----------------

    The following can be upgraded remotely:

    Eiger      via bit files
    Jungfrau   via command <.pof>
    Mythen3    via command <.rbf>
    Gotthard2  via command <.rbf>
    Moench     via command <.pof>
    Ctb        via command <.pof>

    Gotthard cannot be upgraded remotely  

    Except Eiger, 
        upgrade 
            Using command 'programfpga' or

        udpate both server and firmware simultaneously
            Using command 'update'


    Instructions available at
        https://slsdetectorgroup.github.io/devdoc/firmware.html




4 Kernel Requirements
======================

    Blackfin 
    --------
    Latest version: Fri Oct 29 00:00:00 2021
    
    Older ones will work, but might have issues with programming firmware via
    the package.

    Nios
    -----
    Compatible version: Mon May 10 18:00:21 CEST 2021

    Kernel Upgrade
    ---------------
    Eiger   via bit files
    Others  via command

    Commands: udpatekernel, kernelversion
    Instructions available at
        https://slsdetectorgroup.github.io/devdoc/commandline.html
        https://slsdetectorgroup.github.io/devdoc/detector.html
        https://slsdetectorgroup.github.io/devdoc/pydetector.html




5 Download, Documentation & Support
====================================

    Download
    --------
    
    The Source Code:
         https://github.com/slsdetectorgroup/slsDetectorPackage
            
    Documentation
    -------------
    
    Installation:
        https://slsdetectorgroup.github.io/devdoc/installation.html

    Quick Start Guide:
        https://slsdetectorgroup.github.io/devdoc/quick_start_guide.html
        
    Firmware Upgrade:
        https://slsdetectorgroup.github.io/devdoc/firmware.html

    Detector Server upgrade:
        https://slsdetectorgroup.github.io/devdoc/serverupgrade.html

    Detector Simulators:
        https://slsdetectorgroup.github.io/devdoc/virtualserver.html

    Consuming slsDetectorPackage:
        https://slsdetectorgroup.github.io/devdoc/consuming.html
        
    API Examples:
        https://github.com/slsdetectorgroup/api-examples

    Command Line Documentation:
        https://slsdetectorgroup.github.io/devdoc/commandline.html

    C++ API Documentation:
        https://slsdetectorgroup.github.io/devdoc/detector.html
       
    C++ API Example:
        https://slsdetectorgroup.github.io/devdoc/examples.html#
        
    Python API Documentation:
        https://slsdetectorgroup.github.io/devdoc/pygettingstarted.html

    Python API Example:
        https://slsdetectorgroup.github.io/devdoc/pyexamples.html

    Receivers (including custom receiver):
        https://slsdetectorgroup.github.io/devdoc/receivers.html
        https://slsdetectorgroup.github.io/devdoc/slsreceiver.html

    Detector UDP Header:
        https://slsdetectorgroup.github.io/devdoc/udpheader.html
        https://slsdetectorgroup.github.io/devdoc/udpdetspec.html

    slsReceiver Zmq Format:
        https://slsdetectorgroup.github.io/devdoc/slsreceiver.html#zmq-json-header-format

    TroubleShooting:
        https://slsdetectorgroup.github.io/devdoc/troubleshooting.html
        https://slsdetectorgroup.github.io/devdoc/troubleshooting.html#receiver-pc-tuning-options
        
    Further Documentation:
        https://www.psi.ch/en/detectors/documentation
        
    Info on Releases:
        https://www.psi.ch/en/detectors/software


    Support
    -------

        dhanya.thattil@psi.ch
        erik.frojdh@psi.ch
